{"ast":null,"code":"var _jsxFileName = \"/Users/sonjong-il/Desktop/wecode/12-AIG-frontend/src/pages/Cart/Cart.js\";\nimport React, { useState, useEffect } from \"react\";\nimport styled from \"styled-components\";\nimport CartItem from \"./components/CartItem\";\nimport PriceContainer from \"./components/PriceContainer\";\nimport { cartAPI } from \"../../config\";\nexport default function Cart() {\n  const [cart, setCart] = useState();\n  const [totalPrice, setTotalPrice] = useState(0);\n  useEffect(() => {\n    fetchCart();\n  }, []);\n\n  const fetchCart = async () => {\n    // const result = await fetch(cartAPI, {\n    //   headers: { Authorization: localStorage.getItem(\"token\") },\n    // });\n    const result = await fetch(`/Data/cart-Data.json`);\n    const {\n      data\n    } = await result.json();\n    setCart(data);\n  };\n  /* eslint-disable react-hooks/exhaustive-deps */\n\n\n  const totalCalc = () => {\n    const price = cart === null || cart === void 0 ? void 0 : cart.products.reduce((accumulator, item) => {\n      return accumulator + item.price * item.count;\n    }, 0);\n    setTotalPrice(price);\n  };\n\n  useEffect(() => {\n    totalCalc();\n  }, [cart, totalCalc]);\n\n  const deleteCart = i => {\n    const cartList = { ...cart\n    };\n    const updateItem = cartList.products.filter(item => item.id !== cart.products[i].id);\n    cartList.products = updateItem;\n    setCart(cartList);\n  };\n\n  const fetchRemove = async idx => {\n    try {\n      const deleteResult = await fetch(cartAPI, {\n        method: \"delete\",\n        headers: {\n          Authorization: localStorage.getItem(\"token\")\n        },\n        body: JSON.stringify({\n          cart_id: cart.products[idx].cart_id\n        })\n      });\n      const {\n        message\n      } = await deleteResult.json();\n      console.log(message);\n    } catch (err) {\n      alert(err);\n    }\n  };\n\n  const fetchCount = async idx => {\n    const patchResult = await fetch(cartAPI, {\n      method: \"patch\",\n      headers: {\n        Authorization: localStorage.getItem(\"token\")\n      },\n      body: JSON.stringify({\n        cart_id: cart.products[idx].cart_id,\n        count: cart.products[idx].count\n      })\n    });\n\n    try {\n      const {\n        message\n      } = await patchResult.json();\n      console.log(message);\n    } catch (err) {\n      alert(err);\n    }\n  };\n\n  const changeCount = (idx, change) => {\n    const cartList = { ...cart\n    };\n    const updateItem = {\n      id: cart.products[idx].id,\n      cart_id: cart.products[idx].cart_id,\n      title: cart.products[idx].title,\n      count: cart.products[idx].count + change,\n      price: cart.products[idx].price,\n      size: cart.products[idx].size,\n      color: cart.products[idx].color,\n      serial_num: cart.products[idx].serial_num,\n      main_image: cart.products[idx].main_image\n    };\n    cartList.products[idx] = updateItem;\n    setCart(cartList);\n\n    if (cartList.products[idx].count === 0 && change === -1) {\n      fetchRemove(idx);\n      deleteCart(idx);\n    } else {\n      fetchCount(idx);\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Nav, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 9\n    }\n  }, \"\\uC9C4\\uD76C Nav\")), /*#__PURE__*/React.createElement(Section, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(CartContainer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 11\n    }\n  }, \"Shopping bag\"), cart === null || cart === void 0 ? void 0 : cart.products.map((item, idx) => {\n    return /*#__PURE__*/React.createElement(CartItem, {\n      key: idx,\n      cart: cart,\n      idx: idx,\n      item: item,\n      changeCount: changeCount,\n      deleteCart: deleteCart,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 15\n      }\n    });\n  })), /*#__PURE__*/React.createElement(PriceContainer, {\n    totalPrice: totalPrice,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 9\n    }\n  })));\n}\nconst Nav = styled.div`\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 60px;\n  background-color: yellow;\n  text-align: center;\n  span {\n    font-size: 40px;\n  }\n`;\nconst Section = styled.section`\n  display: flex;\n  justify-content: center;\n  max-width: 1000px;\n  margin: 0 auto;\n`;\nconst CartContainer = styled.div`\n  margin-right: 40px;\n  width: calc(66.66% - 20px);\n  border-bottom: 2px solid black;\n  margin-bottom: 100px;\n  height: 100%;\n  h2 {\n    margin-top: 20px;\n    padding-bottom: 13px;\n    font-size: 20px;\n    border-bottom: 2px solid black;\n  }\n`;","map":{"version":3,"sources":["/Users/sonjong-il/Desktop/wecode/12-AIG-frontend/src/pages/Cart/Cart.js"],"names":["React","useState","useEffect","styled","CartItem","PriceContainer","cartAPI","Cart","cart","setCart","totalPrice","setTotalPrice","fetchCart","result","fetch","data","json","totalCalc","price","products","reduce","accumulator","item","count","deleteCart","i","cartList","updateItem","filter","id","fetchRemove","idx","deleteResult","method","headers","Authorization","localStorage","getItem","body","JSON","stringify","cart_id","message","console","log","err","alert","fetchCount","patchResult","changeCount","change","title","size","color","serial_num","main_image","map","Nav","div","Section","section","CartContainer"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport styled from \"styled-components\";\nimport CartItem from \"./components/CartItem\";\nimport PriceContainer from \"./components/PriceContainer\";\nimport { cartAPI } from \"../../config\";\n\nexport default function Cart() {\n  const [cart, setCart] = useState();\n  const [totalPrice, setTotalPrice] = useState(0);\n\n  useEffect(() => {\n    fetchCart();\n  }, []);\n\n  const fetchCart = async () => {\n    // const result = await fetch(cartAPI, {\n    //   headers: { Authorization: localStorage.getItem(\"token\") },\n    // });\n    const result = await fetch(`/Data/cart-Data.json`);\n    const { data } = await result.json();\n    setCart(data);\n  };\n  /* eslint-disable react-hooks/exhaustive-deps */\n  const totalCalc = () => {\n    const price = cart?.products.reduce((accumulator, item) => {\n      return accumulator + item.price * item.count;\n    }, 0);\n    setTotalPrice(price);\n  };\n\n  useEffect(() => {\n    totalCalc();\n  }, [cart, totalCalc]);\n\n  const deleteCart = (i) => {\n    const cartList = { ...cart };\n    const updateItem = cartList.products.filter(\n      (item) => item.id !== cart.products[i].id\n    );\n    cartList.products = updateItem;\n    setCart(cartList);\n  };\n\n  const fetchRemove = async (idx) => {\n    try {\n      const deleteResult = await fetch(cartAPI, {\n        method: \"delete\",\n        headers: { Authorization: localStorage.getItem(\"token\") },\n        body: JSON.stringify({\n          cart_id: cart.products[idx].cart_id,\n        }),\n      });\n      const { message } = await deleteResult.json();\n      console.log(message);\n    } catch (err) {\n      alert(err);\n    }\n  };\n\n  const fetchCount = async (idx) => {\n    const patchResult = await fetch(cartAPI, {\n      method: \"patch\",\n      headers: { Authorization: localStorage.getItem(\"token\") },\n      body: JSON.stringify({\n        cart_id: cart.products[idx].cart_id,\n        count: cart.products[idx].count,\n      }),\n    });\n    try {\n      const { message } = await patchResult.json();\n      console.log(message);\n    } catch (err) {\n      alert(err);\n    }\n  };\n\n  const changeCount = (idx, change) => {\n    const cartList = { ...cart };\n    const updateItem = {\n      id: cart.products[idx].id,\n      cart_id: cart.products[idx].cart_id,\n      title: cart.products[idx].title,\n      count: cart.products[idx].count + change,\n      price: cart.products[idx].price,\n      size: cart.products[idx].size,\n      color: cart.products[idx].color,\n      serial_num: cart.products[idx].serial_num,\n      main_image: cart.products[idx].main_image,\n    };\n    cartList.products[idx] = updateItem;\n    setCart(cartList);\n\n    if (cartList.products[idx].count === 0 && change === -1) {\n      fetchRemove(idx);\n      deleteCart(idx);\n    } else {\n      fetchCount(idx);\n    }\n  };\n\n  return (\n    <>\n      <Nav>\n        <span>진희 Nav</span>\n      </Nav>\n      <Section>\n        <CartContainer>\n          <h2>Shopping bag</h2>\n          {cart?.products.map((item, idx) => {\n            return (\n              <CartItem\n                key={idx}\n                cart={cart}\n                idx={idx}\n                item={item}\n                changeCount={changeCount}\n                deleteCart={deleteCart}\n              />\n            );\n          })}\n        </CartContainer>\n        <PriceContainer totalPrice={totalPrice} />\n      </Section>\n    </>\n  );\n}\n\nconst Nav = styled.div`\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 60px;\n  background-color: yellow;\n  text-align: center;\n  span {\n    font-size: 40px;\n  }\n`;\n\nconst Section = styled.section`\n  display: flex;\n  justify-content: center;\n  max-width: 1000px;\n  margin: 0 auto;\n`;\n\nconst CartContainer = styled.div`\n  margin-right: 40px;\n  width: calc(66.66% - 20px);\n  border-bottom: 2px solid black;\n  margin-bottom: 100px;\n  height: 100%;\n  h2 {\n    margin-top: 20px;\n    padding-bottom: 13px;\n    font-size: 20px;\n    border-bottom: 2px solid black;\n  }\n`;\n"]},"metadata":{},"sourceType":"module"}