{"ast":null,"code":"var _jsxFileName = \"/Users/sonjong-il/Desktop/wecode/12-AIG-frontend/src/pages/Cart/Cart.js\";\nimport React, { useEffect } from \"react\";\nimport styled from \"styled-components\";\nimport { useDispatch, useSelector } from 'react-redux';\nimport CartItem from \"./components/CartItem\";\nimport PriceContainer from \"./components/PriceContainer\";\nimport Nav from \"../../components/Nav\";\nimport { API } from \"../../config\";\nimport { getItems, increaseCount, decreaseCount, removeItem } from '../../modules/cart';\nexport default function Cart() {\n  const dispatch = useDispatch();\n  const {\n    items,\n    totalPrice\n  } = useSelector(({\n    cart\n  }) => ({\n    items: cart.items,\n    totalPrice: cart.totalPrice\n  }));\n  useEffect(() => {\n    (async () => {\n      const result = await fetch(`/Data/cart-Data.json`, {\n        // const result = await fetch(`${API}/cart`, {\n        headers: {\n          Authorization: localStorage.getItem(\"token\")\n        }\n      });\n      const {\n        data\n      } = await result.json();\n      dispatch(getItems(data));\n    })();\n  }, [dispatch]);\n\n  const deleteCart = idx => {\n    const cartList = [...items];\n    const updateItem = cartList.filter(item => item.cart_id !== items[idx].cart_id);\n    dispatch(removeItem(updateItem));\n  };\n\n  const fetchRemove = async idx => {\n    try {\n      const deleteResult = await fetch(`${API}/cart`, {\n        method: \"delete\",\n        headers: {\n          Authorization: localStorage.getItem(\"token\")\n        },\n        body: JSON.stringify({\n          cart_id: items[idx].cart_id\n        })\n      });\n      const {\n        message\n      } = await deleteResult.json();\n\n      if (message === \"SUCCESS\") {\n        deleteCart(idx);\n      }\n    } catch (err) {\n      console.log(err);\n    }\n  };\n\n  const fetchCount = async (idx, change, cartList) => {\n    try {\n      const patchResult = await fetch(`${API}/cart`, {\n        method: \"patch\",\n        headers: {\n          Authorization: localStorage.getItem(\"token\")\n        },\n        body: JSON.stringify({\n          cart_id: items[idx].cart_id,\n          count: cartList[idx].count\n        })\n      });\n      const {\n        message\n      } = await patchResult.json();\n\n      if (message === \"SUCCESS\") {\n        if (change === 1) {\n          dispatch(increaseCount(cartList));\n        } else {\n          dispatch(decreaseCount(cartList));\n        }\n      }\n    } catch (err) {\n      console.log(err);\n    }\n  };\n\n  const changeCount = (idx, change) => {\n    const cartList = [...items];\n    const isSame = item[index] === idx;\n    const isDelete = cartList[idx].count === 0 && change === -1; // console.log(idx)\n    // const test =(idx) => {\n    //   items.map((item, index ) => {\n    //     if(item[index] === idx) {\n    //       console.log(\"같다\")\n    //     }\n    //   })\n    // }\n    // test()\n\n    const updateItem = { ...items[idx],\n      count: items[idx].count + change\n    };\n    cartList[idx] = updateItem;\n    items.map((item, index) => {\n      if (isSame) {\n        console.log(\"같다\");\n      }\n\n      e;\n    });\n    if (isDelete) fetchRemove(idx);\n    if (!isDelete) fetchCount(idx, change, cartList);\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Nav, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(Section, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(CartContainer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 11\n    }\n  }, \"Shopping bag\"), items === null || items === void 0 ? void 0 : items.map((item, idx) => /*#__PURE__*/React.createElement(CartItem, {\n    key: idx,\n    cart: items,\n    idx: idx,\n    item: item,\n    changeCount: changeCount,\n    deleteCart: deleteCart,\n    fetchRemove: fetchRemove,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 15\n    }\n  }))), /*#__PURE__*/React.createElement(PriceContainer, {\n    totalPrice: totalPrice,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 9\n    }\n  })));\n}\nconst Section = styled.section`\n  display: flex;\n  justify-content: center;\n  max-width: 1000px;\n  margin: 0 auto;\n`;\nconst CartContainer = styled.div`\n  margin-right: 40px;\n  width: calc(66.66% - 20px);\n  border-bottom: 2px solid black;\n  margin-bottom: 100px;\n  height: 100%;\n\n  h2 {\n    margin-top: 20px;\n    padding-bottom: 13px;\n    font-size: 20px;\n    border-bottom: 2px solid black;\n  }\n`;","map":{"version":3,"sources":["/Users/sonjong-il/Desktop/wecode/12-AIG-frontend/src/pages/Cart/Cart.js"],"names":["React","useEffect","styled","useDispatch","useSelector","CartItem","PriceContainer","Nav","API","getItems","increaseCount","decreaseCount","removeItem","Cart","dispatch","items","totalPrice","cart","result","fetch","headers","Authorization","localStorage","getItem","data","json","deleteCart","idx","cartList","updateItem","filter","item","cart_id","fetchRemove","deleteResult","method","body","JSON","stringify","message","err","console","log","fetchCount","change","patchResult","count","changeCount","isSame","index","isDelete","map","e","Section","section","CartContainer","div"],"mappings":"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","sourcesContent":["import React, { useEffect } from \"react\";\nimport styled from \"styled-components\";\nimport {useDispatch, useSelector} from 'react-redux'\nimport CartItem from \"./components/CartItem\";\nimport PriceContainer from \"./components/PriceContainer\";\nimport Nav from \"../../components/Nav\";\nimport { API } from \"../../config\";\nimport {getItems, increaseCount, decreaseCount, removeItem} from '../../modules/cart';\n\nexport default function Cart() {\n  const dispatch = useDispatch();\n  const {items, totalPrice} = useSelector(({cart}) => ({\n    items: cart.items,\n    totalPrice: cart.totalPrice\n  }))\n\n  useEffect(() => {\n    (async () => {\n      const result = await fetch(`/Data/cart-Data.json`, {\n      // const result = await fetch(`${API}/cart`, {\n        headers: { Authorization: localStorage.getItem(\"token\") },\n      })\n      const {data} = await result.json();\n      dispatch(getItems(data))\n    })()\n  }, [dispatch]);\n\n  const deleteCart = (idx) => {\n    const cartList = [...items];\n    const updateItem = cartList.filter(\n      (item) => item.cart_id !== items[idx].cart_id\n    );\n    dispatch(removeItem(updateItem));\n  };\n\n  const fetchRemove = async (idx) => {\n    try {\n      const deleteResult = await fetch(`${API}/cart`, {\n        method: \"delete\",\n        headers: { Authorization: localStorage.getItem(\"token\") },\n        body: JSON.stringify({\n          cart_id: items[idx].cart_id,\n        }),\n      });\n      const { message } = await deleteResult.json();\n\n      if (message === \"SUCCESS\") {\n        deleteCart(idx);\n      }\n    } catch (err) {\n      console.log(err);\n    }\n  };\n\n  const fetchCount = async (idx, change, cartList) => {\n    try {\n      const patchResult = await fetch(`${API}/cart`, {\n        method: \"patch\",\n        headers: { Authorization: localStorage.getItem(\"token\") },\n        body: JSON.stringify({\n          cart_id: items[idx].cart_id,\n          count: cartList[idx].count,\n        }),\n      });\n      const { message } = await patchResult.json();\n\n      if (message === \"SUCCESS\") {\n        if (change === 1) {\n          dispatch(increaseCount(cartList))\n        } else {\n          dispatch(decreaseCount(cartList))\n        }\n      }\n    } catch (err) {\n      console.log(err);\n    }\n  };\n\n  const changeCount = (idx, change) => {\n    const cartList = [...items];\n\n    const isSame = item[index] === idx;\n    const isDelete = cartList[idx].count === 0 && change === -1\n\n    // console.log(idx)\n\n    // const test =(idx) => {\n    //   items.map((item, index ) => {\n    //     if(item[index] === idx) {\n    //       console.log(\"같다\")\n    //     }\n    //   })\n    // }\n    // test()\n\n    const updateItem = {\n      ...items[idx],\n      count: items[idx].count + change,\n    };\n\n    cartList[idx] = updateItem;\n\n    items.map((item, index ) => {\n      if(isSame) {\n        console.log(\"같다\")\n      }\n      e\n    })\n\n    if (isDelete) fetchRemove(idx);\n    if (!isDelete) fetchCount(idx, change, cartList);\n  };\n\n  return (\n    <>\n      <Nav />\n      <Section>\n        <CartContainer>\n          <h2>Shopping bag</h2>\n          {items?.map((item, idx) => (\n              <CartItem\n                key={idx}\n                cart={items}\n                idx={idx}\n                item={item}\n                changeCount={changeCount}\n                deleteCart={deleteCart}\n                fetchRemove={fetchRemove}\n              />\n            )\n          )}\n        </CartContainer>\n        <PriceContainer totalPrice={totalPrice} />\n      </Section>\n    </>\n  );\n}\n\nconst Section = styled.section`\n  display: flex;\n  justify-content: center;\n  max-width: 1000px;\n  margin: 0 auto;\n`;\n\nconst CartContainer = styled.div`\n  margin-right: 40px;\n  width: calc(66.66% - 20px);\n  border-bottom: 2px solid black;\n  margin-bottom: 100px;\n  height: 100%;\n\n  h2 {\n    margin-top: 20px;\n    padding-bottom: 13px;\n    font-size: 20px;\n    border-bottom: 2px solid black;\n  }\n`;\n"]},"metadata":{},"sourceType":"module"}