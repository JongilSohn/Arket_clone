{"ast":null,"code":"var _jsxFileName = \"/Users/sonjong-il/Desktop/wecode/12-AIG-frontend/src/pages/Cart/Cart.js\";\nimport React, { useState, useEffect } from \"react\";\nimport styled from \"styled-components\";\nimport CartItem from \"./components/CartItem\";\nimport PriceContainer from \"./components/PriceContainer\";\nimport Nav from \"../../components/Nav\";\nimport { API } from \"../../config\";\nexport default function Cart() {\n  const [cart, setCart] = useState([]);\n  const [totalPrice, setTotalPrice] = useState(0);\n  useEffect(() => {\n    fetchCart();\n  }, []);\n\n  const fetchCart = async () => {\n    try {\n      const result = await fetch(\"/Data/cart-Data.json\"); // const result = await fetch(`${API}/cart`, {\n      //   headers: { Authorization: localStorage.getItem(\"token\") },\n      // });\n\n      const {\n        data\n      } = await result.json();\n      console.log(data);\n      setCart(data);\n    } catch (err) {\n      console.log(err);\n    }\n  };\n\n  useEffect(() => {\n    const totalCalc = () => {\n      const price = cart === null || cart === void 0 ? void 0 : cart.reduce((accumulator, item) => {\n        return accumulator + item.price * item.count;\n      }, 0);\n      setTotalPrice(price);\n    };\n\n    totalCalc();\n  }, [cart]);\n\n  const deleteCart = idx => {\n    console.log();\n    const cartList = [...cart];\n    const updateItem = cartList.filter( // (item) => item.cart_id !== cart[idx].cart_id\n    el => console.log(el.cart_id));\n    setCart(updateItem);\n  };\n\n  const fetchRemove = async idx => {\n    try {\n      const deleteResult = await fetch(`${API}/cart`, {\n        method: \"delete\",\n        headers: {\n          Authorization: localStorage.getItem(\"token\")\n        },\n        body: JSON.stringify({\n          cart_id: cart[idx].cart_id\n        })\n      });\n      const {\n        message\n      } = await deleteResult.json();\n\n      if (message === \"SUCCESS\") {\n        deleteCart(idx);\n      }\n    } catch (err) {\n      alert(\"백엔드에 \", err, \"를 확인해보세요.\");\n    }\n  };\n\n  const fetchCount = async (idx, cartList) => {\n    try {\n      const patchResult = await fetch(`${API}/cart`, {\n        method: \"patch\",\n        headers: {\n          Authorization: localStorage.getItem(\"token\")\n        },\n        body: JSON.stringify({\n          cart_id: cart[idx].cart_id,\n          count: cartList[idx].count\n        })\n      });\n      const {\n        message\n      } = await patchResult.json();\n\n      if (message === \"SUCCESS\") {\n        setCart(cartList);\n      }\n    } catch (err) {\n      alert(\"백엔드에 \" + err + \"를 확인해보세요.\");\n    }\n  };\n\n  const changeCount = (idx, change) => {\n    const cartList = [...cart];\n    const updateItem = { ...cart[idx],\n      count: cart[idx].count + change\n    };\n    cartList[idx] = updateItem;\n\n    if (cartList[idx].count === 0 && change === -1) {\n      fetchRemove(idx);\n    } else {\n      fetchCount(idx, cartList);\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Nav, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(Section, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(CartContainer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 11\n    }\n  }, \"Shopping bag\"), cart === null || cart === void 0 ? void 0 : cart.map((item, idx) => {\n    return /*#__PURE__*/React.createElement(CartItem, {\n      key: idx,\n      cart: cart,\n      idx: idx,\n      item: item,\n      changeCount: changeCount,\n      deleteCart: deleteCart,\n      fetchRemove: fetchRemove,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 15\n      }\n    });\n  })), /*#__PURE__*/React.createElement(PriceContainer, {\n    totalPrice: totalPrice,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 9\n    }\n  })));\n}\nconst Section = styled.section`\n  display: flex;\n  justify-content: center;\n  max-width: 1000px;\n  margin: 0 auto;\n`;\nconst CartContainer = styled.div`\n  margin-right: 40px;\n  width: calc(66.66% - 20px);\n  border-bottom: 2px solid black;\n  margin-bottom: 100px;\n  height: 100%;\n  h2 {\n    margin-top: 20px;\n    padding-bottom: 13px;\n    font-size: 20px;\n    border-bottom: 2px solid black;\n  }\n`;","map":{"version":3,"sources":["/Users/sonjong-il/Desktop/wecode/12-AIG-frontend/src/pages/Cart/Cart.js"],"names":["React","useState","useEffect","styled","CartItem","PriceContainer","Nav","API","Cart","cart","setCart","totalPrice","setTotalPrice","fetchCart","result","fetch","data","json","console","log","err","totalCalc","price","reduce","accumulator","item","count","deleteCart","idx","cartList","updateItem","filter","el","cart_id","fetchRemove","deleteResult","method","headers","Authorization","localStorage","getItem","body","JSON","stringify","message","alert","fetchCount","patchResult","changeCount","change","map","Section","section","CartContainer","div"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport styled from \"styled-components\";\nimport CartItem from \"./components/CartItem\";\nimport PriceContainer from \"./components/PriceContainer\";\nimport Nav from \"../../components/Nav\";\nimport { API } from \"../../config\";\n\nexport default function Cart() {\n  const [cart, setCart] = useState([]);\n  const [totalPrice, setTotalPrice] = useState(0);\n\n  useEffect(() => {\n    fetchCart();\n  }, []);\n\n  const fetchCart = async () => {\n    try {\n      const result = await fetch(\"/Data/cart-Data.json\");\n      // const result = await fetch(`${API}/cart`, {\n      //   headers: { Authorization: localStorage.getItem(\"token\") },\n      // });\n      const { data } = await result.json();\n      console.log(data);\n      setCart(data);\n    } catch (err) {\n      console.log(err);\n    }\n  };\n\n  useEffect(() => {\n    const totalCalc = () => {\n      const price = cart?.reduce((accumulator, item) => {\n        return accumulator + item.price * item.count;\n      }, 0);\n      setTotalPrice(price);\n    };\n    totalCalc();\n  }, [cart]);\n\n  const deleteCart = (idx) => {\n    console.log();\n    const cartList = [...cart];\n    const updateItem = cartList.filter(\n      // (item) => item.cart_id !== cart[idx].cart_id\n      (el) => console.log(el.cart_id)\n    );\n    setCart(updateItem);\n  };\n\n  const fetchRemove = async (idx) => {\n    try {\n      const deleteResult = await fetch(`${API}/cart`, {\n        method: \"delete\",\n        headers: { Authorization: localStorage.getItem(\"token\") },\n        body: JSON.stringify({\n          cart_id: cart[idx].cart_id,\n        }),\n      });\n      const { message } = await deleteResult.json();\n      if (message === \"SUCCESS\") {\n        deleteCart(idx);\n      }\n    } catch (err) {\n      alert(\"백엔드에 \", err, \"를 확인해보세요.\");\n    }\n  };\n\n  const fetchCount = async (idx, cartList) => {\n    try {\n      const patchResult = await fetch(`${API}/cart`, {\n        method: \"patch\",\n        headers: { Authorization: localStorage.getItem(\"token\") },\n        body: JSON.stringify({\n          cart_id: cart[idx].cart_id,\n          count: cartList[idx].count,\n        }),\n      });\n\n      const { message } = await patchResult.json();\n      if (message === \"SUCCESS\") {\n        setCart(cartList);\n      }\n    } catch (err) {\n      alert(\"백엔드에 \" + err + \"를 확인해보세요.\");\n    }\n  };\n\n  const changeCount = (idx, change) => {\n    const cartList = [...cart];\n    const updateItem = {\n      ...cart[idx],\n      count: cart[idx].count + change,\n    };\n    cartList[idx] = updateItem;\n    if (cartList[idx].count === 0 && change === -1) {\n      fetchRemove(idx);\n    } else {\n      fetchCount(idx, cartList);\n    }\n  };\n\n  return (\n    <>\n      <Nav />\n      <Section>\n        <CartContainer>\n          <h2>Shopping bag</h2>\n          {cart?.map((item, idx) => {\n            return (\n              <CartItem\n                key={idx}\n                cart={cart}\n                idx={idx}\n                item={item}\n                changeCount={changeCount}\n                deleteCart={deleteCart}\n                fetchRemove={fetchRemove}\n              />\n            );\n          })}\n        </CartContainer>\n        <PriceContainer totalPrice={totalPrice} />\n      </Section>\n    </>\n  );\n}\n\nconst Section = styled.section`\n  display: flex;\n  justify-content: center;\n  max-width: 1000px;\n  margin: 0 auto;\n`;\n\nconst CartContainer = styled.div`\n  margin-right: 40px;\n  width: calc(66.66% - 20px);\n  border-bottom: 2px solid black;\n  margin-bottom: 100px;\n  height: 100%;\n  h2 {\n    margin-top: 20px;\n    padding-bottom: 13px;\n    font-size: 20px;\n    border-bottom: 2px solid black;\n  }\n`;\n"]},"metadata":{},"sourceType":"module"}